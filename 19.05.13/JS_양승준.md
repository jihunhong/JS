# 18장 HTTP스크립팅
#### 개요
* http는 웹브라우저가 서버로부터 문서를 전송 받거나 폼의 내용을 보내는 방법, 그리고 해당 요청의 내용에 대해 서버가 응답하는 방법을 명세한다.
웹브라우저는 많은 양의 http를 처리하는데, 일반적으로 http는 스크립트의 제어를 받지 않는 대신 사용자가 링크를 클릭하거나 폼을 전송하거나 URL을 직접 입력할 때 발생한다.
`AJax`는 HTTP를 조작하는 데 특화된 웹 애플리케이션 설계 방식을 가리키는 용어이다.
`AJax`는 http를 조작하여, 페이지를 다시 불러오지 않고도 웹 서버와 데이터를 교환할 수 있도록 하는 것이다.
페이지를 다시 불러오지 않고 데이터를 처리할 수 있따는 말은 결과적으로 좀 더 `전통적인 데스크톱 애플리케이션처럼 반응형 웹 애플리케이션` 을 만들 수 있다는 의미다.
이를 이용해서 활용하면 사용자 반응 데이터를 서버에 저장하거나, 처음에 간단한 페이지만 먼저 불러들인 후 추가적인 데이터와 필요한 페이지 구성 요소를 나중에 내려받는 식으로 초기 로딩 시간을 개선할 수 있다.
comet은 http를 조작하는 웹애플리케이션 설계와 관련된 용어이다.
어떤 의미로 Comet은 Ajax와 반대 개념이라고도 할 수 있다.
`Comet`은 비동기적으로 메시지를 클라이언트로 보내는 방식의 통신을 가능하게 하는 웹 서버다. 웹app가 서버로부터 전달받은 메시지에 응답해야 한다면 이때 ajax 기술을 사용하여 데이터를 보내거나 요청할 수 있다.
ajax는 클라이언트가 서버의 데이터를 끌어온다.

#### 18.1 XMLHttpRequest 사용하기
* 브라우저는 XMLHttpRequest 클래스에 HTTP API를 정의한다.
이 클래스의 각 인스턴스는 요청과 응답의 한 쌍을 나타내며, 이 객체의 프로퍼티와 메서드는 요청에 대한 세부사항을 설정하고 응답 데이터를 추출할 수 있도록 한다.
이 HTTP API를 사용하기 위해 제일 먼저 해야 할 일은 xmlhttprequest 객체의 인스턴스를 생성하는 것이다.
```js
var request = new XMLHttpRequest();
//이미 생성된 객체를 재활용할 수도 있지만, 그러기 위해서는 먼저 이 객체에
//걸려있는 요청을 중단시켜야 한다
```

#### 18.1.1 요청 설정하기
* 객체를 생성했다면 XMLHttpRequest 객체의 open()메서드를 사용하여 HTTP 요청을 만드는 데 필요한 두 요소를 지정한다.
```js
request.open("GET","data.csv");
//HTTP Get 요청으로 이 url의 내용을 가져오도록 만든다,
```

open() 메서드의 첫 번째 인자는 HTTP 요청 방식 또는 동사다. 대소문자 구분없이 지정할 수 있으나 HTTP 프로토콜에는 일반적으로 대문자를 사용한다.
`GET`은 가장 `일반적인` 요청이며, 해당 URL이 필요로 하는 리소스를 정확히 가리키고 있을 때나 해당 요청이 서버에 별다른 영향을 끼치지 않을 때, 응답이 캐시될 수 있는 상황일 때 주로 사용된다.
`POST`방식은 HTML폼에서 주로 사용되는 방식으로 추가적인 데이터를 요청 본문에 포함할 수 있고, 해당 데이터는 서버의 데이터베이스에 저장되기도 한다.
똑같은 URL에 반복적으로 POST 요청을 보내더라도 서버의 응답은 각각 다를 수 있으므로 이 방식의 요청은 캐시되지 않아야 한다.
open() 메서드의 두번째 인자는 요청할 목적 URL이다. 이 URL은 open() 메서드를 호출하는 스크립트를 포함하는 문서의 URL과 관련이 있다.
특정 프로토콜과 호스트, 포트를 지정한 절대 URL을 사용할 때는 일반적으로 현재 문서의 URL 구성요소들과 일치해야 한다.

요청과정의 다음 단계는 요청 헤더를 설정하는 것이다. 예를 들어 POST 요청을 보낼 때 본문의 MIME타입으로 "Content-Type" 헤더를 지정할 필요가 있다면 다음과 같이 설정한다
```js
request.setRequestHeader("Content-Type","text/plain");
```
setRequestHeader()을 호출해서 같은 헤더를 여러 번 설정하더라도, 새로 설정한 값은 이전에 설정한 값을 바꿀 수 없다. 그 대신, http 요청에는 같은 헤더의 여러 복사본이나 하나 이상의 값이 지정된 헤더가 포함될 것이다.

#### 18.1.2 응답 데이터 가져오기
* 완료된 HTTP 응답에는 `상태코드`와 `응답헤더` `응답본문` 이 존재한다. 이런 응답에 대한 구성 요소에는 XMLHttpRequest객체의 프로퍼티와 메서드로 접근할 수 있다.
XMLHttpRequest 객체는 보통 비동기 방식으로 사용한다. send() 메서드는 요청을 보낸 즉시 반환되고, 앞에서 언급했던 응답 메서드와 프로퍼티들은 응답 결과를 받기 전까지는 유효하지 않다. 응답이 준비되었음을 통보 받기 위해선 XMLHttpRequest 객체의 readystatechage 이벤트를 사용하거나 XHR2의 새로운 이벤트인 progress를 사용해야 한다.
그러나 이 이벤트 타입에 앞서 readyState 프로퍼티에 대해 이해해야 한다.
`readyState`는 HTTP요청 상태를 나타내는 정수 값이 해당 값들은 표에 나타나있다 `605p 18-1표 참조`
